(function(a){var b=a.document,c=a.navigator,d=a.location;bui={},bui.svgns="http://www.w3.org/2000/svg",bui.settings={initialHighPerformance:!0,idPrefix:{graph:"graph",node:"node",edge:"edge",connectingArc:"connectingArc"},idSuffix:{hover:"hover"},css:{stylesheetUrl:"resources/css/visualization-svg.css",classes:{invisible:"hidden",selected:"selected",placeholder:"placeholder",rectangle:"rect",complex:"complex",compartment:"compartment",smallText:"small",textDimensionCalculation:{generic:"textDimensionCalculation",standard:"defaultText",small:"smallText"},line:"line",lineStyle:{solid:"solid",dotted:"dotted",dashed:"dashed"},lineHover:"lineHover",connectingArcs:{stimulation:"stimulation",catalysis:"catalysis",modulation:"modulation",necessaryStimulation:"necessaryStimulation"},splineEdgeHandle:"splineEdgeHandle",splineAutoEdgeHandle:"autoAlign"}},style:{placeholderCorrection:{position:{x:-1,y:-1},size:{width:-2,height:-2}},edgeHandleRadius:4,nodeCornerRadius:25,adaptToLabelNodePadding:{top:5,right:5,bottom:5,left:5},complexCornerRadius:25,compartmentCornerRadius:{x:25,y:15},processNodeMinSize:{width:26,height:26},edgeToNodePadding:{topBottom:5,leftRight:5},importer:{standardNodeSize:{width:70,height:70},sizeBasedOnLabelPassing:{horizontal:20,vertical:20}},markerWidthCorrection:.25}},function(a){var b=[];a.ready=function(a){b.push(a)},$(function(){for(var a=0;a<b.length;a++)b[a]()}),a.Object=function(){this.__private={}},a.Object.prototype._getPrivateMembers=function(a){var b=this.__private[a];b===undefined&&(b={},this.__private[a]=b);return b},a.Object.prototype._privates=function(a){return this._getPrivateMembers(a)}}(bui);var e=function(a,b,c){var d=this.size().width/2;d+=Math.sqrt(Math.pow(c.topBottom,2)+Math.pow(c.leftRight,2));return{opposite:Math.sin(b)*d,adjacent:Math.cos(b)*d}},f=function(a,b){return e.call(this,a,b,bui.settings.style.edgeToNodePadding)},g=function(a,b){return e.call(this,a,b,{topBottom:0,leftRight:0})};(function(a){a.util={},a.util.createPrototypeValue=function(a){return{value:a,enumerable:!0,configurable:!0,writable:!0}},Function.prototype.createDelegate=function(a){var b=this;return function(){return b.apply(a,arguments)}},String.prototype.removeNonNumbers=function(){return this.replace(/[^0-9]/g,"")},String.prototype.endsWith=function(a){return this.indexOf(a,this.length-a.length)!==-1},a.util.calculateWordDimensions=function(c,d,e){d===undefined&&(d=[]),e===undefined&&(e=!0),d.push(a.settings.css.classes.textDimensionCalculation.generic);var f=b.createElement("div");f.setAttribute("class",d.join(" ")),e===!0?$(f).text(c):f.innerHTML=c,b.body.appendChild(f);var g={width:jQuery(f).outerWidth(),height:jQuery(f).outerHeight()};f.parentNode.removeChild(f);return g},a.util.calculateTextDimensions=function(b,c){var d=b.split(/\s/);for(var e=0;e<d.length;e++){var f=d[e],g=a.util.calculateWordDimensions(f,c);g.word=f,d[e]=g}return d},a.util.calculateLabelPositioning=function(b,c,d){var e=a.util.calculateTextDimensions(c,d),f=a.util.calculateWordDimensions("&nbsp;",d,!1).width,g=[],h=null,i=0,j=function(){h!==null&&(h.maxHeight=i),i=0,g.push({words:[],availableWidth:b}),h=g[g.length-1]};j();var k=function(a){h.words.push(a),h.availableWidth-=a.width+f,i=Math.max(i,a.height)};for(var l=0;l<e.length;l++){var m=e[l];m.width<=h.availableWidth?k(m):(h.words.length!==0&&j(),k(m))}h.maxHeight=i;for(l=0;l<g.length;l++){var n=g[l];n.availableWidth+=f,n.horizontalIndention=n.availableWidth/2,n.totalWidth=b-n.availableWidth,n.spaceWidth=f,delete n.availableWidth}return g},a.util.setSuperClass=function(b,c){var d=b.prototype;for(var e in d)if(d.hasOwnProperty(e)){var f=d[e];d[e]=a.util.createPrototypeValue(f)}b.prototype=Object.create(c.prototype,b.prototype),b.superClazz=c};var c=0;a.util.createListenerTypeId=function(){return c++},a.util.createMarkerAttributeValue=function(a){return["url(#",a,")"].join("")},a.util.getHoverId=function(b){return b+a.settings.idSuffix.hover}})(bui);var h=function(a){var b=typeof a;if(b==="number")return a;if(b==="string"&&isNaN(a)===!1)return parseFloat(a);throw"It can't be ensured that the value: \""+a+'" is a number.'},i=function(a){var b=typeof a;if(b==="boolean")return a;if(b==="string")return a.toLowerCase()==="true"||a==="1";if(b==="number")return a===1;throw'The value: "'+a+"can't be converted to boolean."};(function(a){var b="bui.Observable";a.Observable=function(){a.Observable.superClazz.call(this),this._getPrivateMembers(b).listener={}},a.Observable.prototype={_addType:function(a){var c=this._getPrivateMembers(b).listener;if(typeof a=="string")c[a]={};else for(var d in a)a.hasOwnProperty(d)&&(c[a[d]]={});return this},bind:function(a,c,d){var e=this._getPrivateMembers(b).listener[a];if(e===undefined)return this;if(d===undefined||d===null)d=c;e[d]=c;return this},unbind:function(a,c){var d=this._getPrivateMembers(b).listener;if(a===undefined)for(var e in d)d.hasOwnProperty(e)&&(d[e]={});else c===undefined?d[a]={}:delete d[a][c];return this},unbindAll:function(a){var c=this._getPrivateMembers(b).listener;for(var d in c)c.hasOwnProperty(d)&&delete c[d][a];return this},fire:function(a,c){c===undefined&&(c=[]);var d=this._getPrivateMembers(b).listener[a];if(d===undefined)return!0;for(var e in d)if(d.hasOwnProperty(e)){var f=d[e].apply(this,c);if(f===!1)return!1}return!0}},a.util.setSuperClass(a.Observable,a.Object)})(bui),function(a){a.connectingArcs={};var c=0,d=function(c,d,e,f,g,h,i,j){j===undefined&&(j=1);var k=b.createElementNS(a.svgns,"marker");k.setAttributeNS(null,"id",c),k.setAttributeNS(null,"orient","auto"),k.setAttributeNS(null,"refX",e),k.setAttributeNS(null,"refY",f),k.setAttributeNS(null,"markerWidth",g*j),k.setAttributeNS(null,"markerHeight",h),k.setAttributeNS(null,"viewBox",["-2 -2",g+4,h+4].join(" ")),i!==undefined&&k.setAttributeNS(null,"class",i);if(typeof d=="string"){var l=b.createElementNS(a.svgns,"path");l.setAttributeNS(null,"d",d),k.appendChild(l)}else k.appendChild(d);return k},e=function(b,e,f,g,h,i){var j=a.settings.idPrefix.connectingArc+c++,k=a.util.getHoverId(j),l=d(j,b,e,f,g,h,i),m=d(k,b,e,f,g,h,i,a.settings.style.markerWidthCorrection);return{id:j,hoverId:k,element:l,hoverElement:m}};a.connectingArcs.stimulation=function(){return e("M0,0L20,10L0,20Z",20,10,20,20,a.settings.css.classes.connectingArcs.stimulation)},a.connectingArcs.stimulation.id="stimulation",a.connectingArcs.inhibition=function(){return e("M0,0V20H1V0Z",0,10,20,20)},a.connectingArcs.inhibition.id="inhibition",a.connectingArcs.catalysis=function(){var c=b.createElementNS(a.svgns,"circle");c.setAttributeNS(null,"cx",10),c.setAttributeNS(null,"cy",10),c.setAttributeNS(null,"r",10);return e(c,20,10,20,20,a.settings.css.classes.connectingArcs.catalysis)},a.connectingArcs.catalysis.id="catalysis",a.connectingArcs.modulation=function(){return e("M10,0L20,10L10,20L0,10Z",20,10,20,20,a.settings.css.classes.connectingArcs.modulation)},a.connectingArcs.modulation.id="modulation",a.connectingArcs.necessaryStimulation=function(){return e("M0,0V20 M5,0L25,10L5,20Z",25,10,26,26,a.settings.css.classes.connectingArcs.necessaryStimulation)},a.connectingArcs.necessaryStimulation.id="necessaryStimulation"}(bui),function(a){var c=0,d="bui.Graph",e=function(a){return d+a.id()},f=function(){var a=this._privates(d),b=["scale(",a.scale.toString(),")"].join("");a.rootGroup.setAttributeNS(null,"transform",b)},g=function(){return"@import url('"+a.settings.css.stylesheetUrl+"');"},h=function(){var c=this._privates(d),e=b.createElement("div");c.container.appendChild(e),c.root=b.createElementNS(a.svgns,"svg"),c.root.setAttributeNS(null,"xmlns",a.svgns),c.root.setAttributeNS(null,"id",c.id),e.appendChild(c.root);var h=jQuery(c.root).offset();c.rootOffset={x:h.left,y:h.top},c.rootDimensions={width:jQuery(c.root).width(),height:jQuery(c.root).height()},c.defsGroup=b.createElementNS(a.svgns,"defs"),c.root.appendChild(c.defsGroup),c.css=b.createElementNS(a.svgns,"style"),c.css.setAttributeNS(null,"type","text/css"),c.css.textContent=g(),c.root.appendChild(c.css),c.rootGroup=b.createElementNS(a.svgns,"g"),f.call(this),c.root.appendChild(c.rootGroup),c.nodeGroup=b.createElementNS(a.svgns,"g"),c.rootGroup.appendChild(c.nodeGroup),c.edgeGroup=b.createElementNS(a.svgns,"g"),c.rootGroup.appendChild(c.edgeGroup),c.placeholderContainer=b.createElement("div"),b.getElementsByTagName("body")[0].appendChild(c.placeholderContainer),c.connectingArcs={};for(var i in a.connectingArcs)if(a.connectingArcs.hasOwnProperty(i)){var j=a.connectingArcs[i](),k=a.connectingArcs[i].id;c.connectingArcs[k]=j,c.defsGroup.appendChild(j.element),c.defsGroup.appendChild(j.hoverElement)}},i=function(a){var b=this._privates(d),c=a.bottomRight();c.x>b.rootDimensions.width&&(b.rootDimensions.width=c.x,b.root.setAttribute("width",c.x)),c.y>b.rootDimensions.height&&(b.rootDimensions.height=c.y,b.root.setAttribute("height",c.y))},j=function(a){delete this._privates(d).drawables[a.id()]};a.Graph=function(b){a.Graph.superClazz.call(this),this._addType(a.Graph.ListenerType);var e=this._privates(d);e.id=a.settings.idPrefix.graph+c++,e.container=b,e.drawables={},e.idCounter=0,e.scale=1,e.highPerformance=a.settings.initialHighPerformance,h.call(this)},a.Graph.prototype={id:function(){return this._privates(d).id},htmlTopLeft:function(){return this._privates(d).rootOffset},topLeft:function(){return{x:0,y:0}},absolutePosition:function(){return{x:0,y:0}},container:function(){return this._privates(d).container},placeholderContainer:function(){return this._privates(d).placeholderContainer},edgeGroup:function(){return this._privates(d).edgeGroup},nodeGroup:function(){return this._privates(d).nodeGroup},suspendRedraw:function(a){return this._privates(d).root.suspendRedraw(a)},unsuspendRedraw:function(a){a!==undefined?this._privates(d).root.unsuspendRedraw(a):this._privates(d).root.unsuspendRedrawAll();return this},scale:function(b){var c=this._privates(d);if(b!==undefined){b!==c.scale&&(c.scale=b,f.call(this),this.fire(a.Graph.ListenerType.scale,[this,b]));return this}return c.scale},add:function(b,c){var f=this._privates(d),g=null,h=f.idCounter++;c===undefined&&(c={}),c.id=h,c.graph=this,g=new b(c),f.drawables[g.id()]=g,g.bind(a.Drawable.ListenerType.remove,j.createDelegate(this),e(this)),g.bottomRight!==undefined&&(g.bind(a.Node.ListenerType.position,i.createDelegate(this),e(this)),g.bind(a.Node.ListenerType.size,i.createDelegate(this),e(this)),i.call(this,g)),this.fire(a.Graph.ListenerType.add,[g]);return g},reduceCanvasSize:function(){var a=this._privates(d),b=Integer.MIN_VALUE,c=Integer.MIN_VALUE;for(var e in a.drawables)if(a.drawables.hasOwnProperty(e)){var f=a.drawables[e];if(f.bottomRight!==undefined){var g=f.bottomRight();b=Math.max(b,g.x),c=Math.max(c,g.y)}}a.rootDimensions.width=b,a.root.setAttribute("width",b),a.rootDimensions.height=c,a.root.setAttribute("height",c)},connectingArcs:function(){return this._privates(d).connectingArcs},rawSVG:function(){var b=this._privates(d).root.parentNode.innerHTML,c="";jQuery.ajax({url:a.settings.css.stylesheetUrl,async:!1,success:function(a){c=a}}),b=b.replace(g(),c);return b},highPerformance:function(a){var b=this._privates(d);if(a!==undefined){b.highPerformance=a;return this}return b.highPerformance}},a.util.setSuperClass(a.Graph,a.Observable),a.Graph.ListenerType={add:a.util.createListenerTypeId(),scale:a.util.createListenerTypeId()}}(bui),function(a){var b="bui.Drawable",c=function(a){return b+a.id()};a.Drawable=function(c){a.Drawable.superClazz.call(this),this._addType(a.Drawable.ListenerType);var d=this._privates(b);d.id=c.id,d.graph=c.graph,d.classes=[],d.visible=!1,d.select=!1,d.json=null},a.Drawable.prototype={id:function(){return this._privates(b).id},graph:function(){return this._privates(b).graph},remove:function(){this.fire(a.Drawable.ListenerType.remove,[this]),this.unbind()},select:function(c){var d=this._privates(b);if(c!==undefined){d.select!==c&&(d.select=c,this.fire(a.Drawable.ListenerType.select,[this,c]));return this}return d.select},visible:function(c){var d=this._privates(b);if(c!==undefined){d.visible!==c&&(d.visible=c,this.fire(a.Drawable.ListenerType.visible,[this,c]));return this}return d.visible},isSameGraph:function(a){return this._privates(b).graph.id()==node._privates(b).graph.id()},addClass:function(c){var d=this._privates(b).classes;d.indexOf(c)==-1&&(d.push(c),this.fire(a.Drawable.ListenerType.classes,[this,this.classString()]));return this},removeClass:function(c){var d=this._privates(b).classes,e=d.indexOf(c);e!=-1&&(d.splice(e,1),this.fire(a.Drawable.ListenerType.classes,[this,this.classString()]));return this},classString:function(){return this._privates(b).classes.join(" ")},json:function(a){var c=this._privates(b);if(a!==undefined){c.json=a;return this}return c.json}},a.util.setSuperClass(a.Drawable,a.Observable),a.Drawable.ListenerType={visible:a.util.createListenerTypeId(),remove:a.util.createListenerTypeId(),select:a.util.createListenerTypeId(),classes:a.util.createListenerTypeId()}}(bui),function(a){var c="bui.Node",d=function(b){var c=a.settings.css.classes.placeholder;b===!1&&(c+=" "+a.settings.css.classes.invisible);return c},e=function(a){return c+a.id()},f=function(){var b=this._privates(c),d=this.htmlTopLeft(),e=a.settings.style.placeholderCorrection.position;b.placeholder.style.left=d.x+e.x+"px",b.placeholder.style.top=d.y+e.y+"px",e=a.settings.style.placeholderCorrection.size,b.placeholder.style.width=b.width+e.width+"px",b.placeholder.style.height=b.height+e.height+"px"},g=function(){var b=this._privates(c),d=this.absolutePosition(),e=["translate(",d.x.toString(),",",d.y.toString(),")"].join("");b.nodeGroup.setAttributeNS(null,"transform",e),f.call(this),this.fire(a.Node.ListenerType.absolutePosition,[this,d.x,d.y])},h=function(){f.call(this)},i=function(){var b=this._privates(c),d=jQuery(b.placeholder).offset(),e=d.left,f=d.top,g=b.parent.htmlTopLeft();e-=g.x,f-=g.y;var h=a.settings.style.placeholderCorrection.position;e+=h.x*-1,f+=h.y*-1;var i=this.graph().suspendRedraw(200);this.position(e,f),this.graph().unsuspendRedraw(i)},j=function(){this.graph().highPerformance()===!0&&i.call(this)},k=function(){var b=this._privates(c),d=jQuery(b.placeholder).width(),e=jQuery(b.placeholder).height(),f=a.settings.style.placeholderCorrection.size;d+=f.width*-1,e+=f.height*-1;var g=this.graph().suspendRedraw(200);this.size(d,e),this.graph().unsuspendRedraw(g)},l=function(){this.graph().highPerformance()===!0&&k.call(this)},m=function(b,c){c===!0?this.removeClass(a.settings.css.classes.invisible):(this.addClass(a.settings.css.classes.invisible),this.placeholderVisible(!1))},n=function(){var a=this._privates(c),b=a.nodeGroup;b.parentNode.removeChild(b);var d=a.placeholder;d.parentNode.removeChild(d)},o=function(){this.parent(this.graph())},p=function(b,c,d){d.unbindAll(e(this)),c.bind(a.Drawable.ListenerType.remove,o.createDelegate(this),e(this)),c.bind(a.Node.ListenerType.absolutePosition,g.createDelegate(this),e(this)),g.call(this)},q=function(a,b){var d=this._privates(c).nodeGroup;d.setAttributeNS(null,"class",b)},r=function(b,c){c===!0?this.addClass(a.settings.css.classes.selected):this.removeClass(a.settings.css.classes.selected)},s=function(a){a.ctrlKey===!0&&this.placeholderVisible(!this.placeholderVisible())},t=function(){var e=this._privates(c);e.nodeGroup=b.createElementNS(a.svgns,"g"),e.nodeGroup.setAttributeNS(null,"id",this.id()),m.call(this,this,this.visible()),this.graph().nodeGroup().appendChild(e.nodeGroup),e.placeholder=b.createElement("div"),e.placeholder.setAttribute("class",d(!1)),this.graph().placeholderContainer().appendChild(e.placeholder),h.call(this),g.call(this),jQuery(e.nodeGroup).add(e.placeholder).click(s.createDelegate(this)),this._enableDragging===!0&&jQuery(e.placeholder).draggable({stop:i.createDelegate(this),drag:j.createDelegate(this)}),this._enableResizing===!0&&jQuery(e.placeholder).resizable({stop:k.createDelegate(this),resize:l.createDelegate(this),aspectRatio:this._forceRectangular?1:!1})};a.Node=function(b){b.id=a.settings.idPrefix.node+b.id,a.Node.superClazz.call(this,b),this._addType(a.Node.ListenerType);var d=this._privates(c);d.x=0,d.y=0,d.width=this._minWidth,d.height=this._minHeight,d.parent=this.graph(),d.children=[],d.placeholderVisible=!1,this.bind(a.Drawable.ListenerType.remove,n.createDelegate(this),e(this)),this.bind(a.Drawable.ListenerType.visible,m.createDelegate(this),e(this)),this.bind(a.Node.ListenerType.parent,p.createDelegate(this),e(this)),this.bind(a.Node.ListenerType.position,g.createDelegate(this),e(this)),this.bind(a.Node.ListenerType.size,f.createDelegate(this),e(this)),this.bind(a.Drawable.ListenerType.classes,q.createDelegate(this),e(this)),this.bind(a.Drawable.ListenerType.select,r.createDelegate(this),e(this)),t.call(this)},a.Node.prototype={_minWidth:10,_minHeight:10,_forceRectangular:!1,_enableResizing:!0,_enableDragging:!0,nodeGroup:function(){return this._privates(c).nodeGroup},position:function(b,d){var e=this._privates(c);if(b!==undefined&&d!==undefined){var f=e.x!==b||e.y!==d;e.x=b,e.y=d,f&&this.fire(a.Node.ListenerType.position,[this,e.x,e.y]);return this}return{x:e.x,y:e.y}},absolutePosition:function(a,b){var d=this._privates(c),e=d.parent.absolutePosition();if(a!==undefined&&b!==undefined){a-=e.x,b-=e.y,this.position(a,b);return this}return{x:e.x+d.x,y:e.y+d.y}},positionCenter:function(a,b){var c=this.size();this.position(a-c.width/2,b-c.height/2);return this},htmlTopLeft:function(){var a=this._privates(c),b=a.parent.htmlTopLeft();return{x:b.x+a.x,y:b.y+a.y}},size:function(b,d){var e=this._privates(c);if(b!==undefined&&d!==undefined){b=Math.max(this._minWidth,b),d=Math.max(this._minHeight,d),this._forceRectangular===!0&&(d=b);var f=e.width!==b||e.height!==d;e.width=b,e.height=d,f&&this.fire(a.Node.ListenerType.size,[this,e.width,e.height]);return this}return{width:e.width,height:e.height}},topLeft:function(){var a=this._privates(c);return{x:a.x,y:a.y}},bottomRight:function(){var a=this._privates(c);return{x:a.x+a.width,y:a.y+a.height}},center:function(){var a=this._privates(c);return{x:a.x+a.width/2,y:a.y+a.height/2}},absoluteCenter:function(){var a=this._privates(c),b=this.absolutePosition();return{x:b.x+a.width/2,y:b.y+a.height/2}},move:function(a,b,d){var e=this._privates(c);if(d===undefined||d<=0)this.position(e.x+a,e.y+b);else throw"Not implemented.";return this},parent:function(b){var d=this._privates(c);if(b!==undefined){if(b!==d.parent){var e=d.parent;d.parent=b,e!==this.graph()&&e._removeChild(this),b!==this.graph()&&b._addChild(this),this.fire(a.Node.ListenerType.parent,[this,b,e])}return this}return d.parent},addChild:function(a){a.parent(this);return this},removeChild:function(a){a.parent(this.graph());return this},_addChild:function(a){this._privates(c).children.push(a)},_removeChild:function(a){var b=this._privates(c).children,d=b.indexOf(a);d!==-1&&b.splice(d,1)},children:function(){return this._privates(c).children},calculateLineEnd:function(b){if(this.visible()===!1)return this.center();var c=this.center(),d=this.size(),e=b.center(),f=a.settings.style.edgeToNodePadding,g=d.width+f.leftRight*2,h=d.height+f.topBottom*2,i=e.x-c.x,j=e.y-c.y,k=Math.abs(Math.atan(j/i)),l=Math.atan(h/g),m=0,n=k<l;n?m=g/2:(m=h/2,k=Math.PI/2-k);var o=this._calculationHook(m,k),p=o.opposite;m=o.adjacent;var q=0,r=0;n?(q=m,r=p):(q=p,r=m);var s=c.y>e.y,t=c.x>e.x;q*=t?-1:1,r*=s?-1:1;return{x:c.x+q,y:c.y+r}},_calculationHook:function(a,b){return{adjacent:a,opposite:Math.tan(b)*a}},placeholderVisible:function(b){var d=this._privates(c);if(b!==undefined){d.placeholderVisible=b,b===!0?jQuery(d.placeholder).removeClass(a.settings.css.classes.invisible):jQuery(d.placeholder).addClass(a.settings.css.classes.invisible);return this}return d.placeholderVisible},startDragging:function(a,b,d){if(d===!0){var e=this.graph().htmlTopLeft();a-=e.x,b-=e.y}this.placeholderVisible(!0);var f=this._privates(c).placeholder;jQuery(f).simulate("mousedown",{clientX:a,clientY:b});return this}},a.util.setSuperClass(a.Node,a.Drawable),a.Node.ListenerType={parent:a.util.createListenerTypeId(),position:a.util.createListenerTypeId(),absolutePosition:a.util.createListenerTypeId(),size:a.util.createListenerTypeId()}}(bui),function(a){var c="bui.Labelable",d=function(a){return c+a.id()},e=function(d){var e=this._privates(c),f=0,g=d[0].maxHeight,h=0;for(var i=0;i<d.length;i++){var j=d[i],k=[];h+=j.maxHeight;for(var l=0;l<j.words.length;l++)k.push(j.words[l].word);var m=b.createElementNS(a.svgns,"tspan");m.appendChild(b.createTextNode(k.join(" "))),m.setAttributeNS(null,"x",j.horizontalIndention),m.setAttributeNS(null,"dy",f),e.labelElement.appendChild(m),f=j.maxHeight}e.labelElement.setAttributeNS(null,"y",this.size().height/2+g-h/2)},f=function(d){var e=this._privates(c),f=[],g=Number.MIN_VALUE,h=0;for(var i=0;i<d.length;i++){var j=d[i];for(var k=0;k<j.words.length;k++)f.push(j.words[k].word);h+=j.totalWidth+j.spaceWidth,g=Math.max(g,j.maxHeight)}h-=d[0].spaceWidth,e.labelElement.appendChild(b.createTextNode(f.join(" ")));var l=a.settings.style.adaptToLabelNodePadding;h+=l.left+l.right;var m=g+l.top+l.bottom;this.size(h,m),e.labelElement.setAttributeNS(null,"x",l.left),e.labelElement.setAttributeNS(null,"y",g)},g=function(){var d=this._privates(c),g=this.label();d.labelElement!==null&&d.labelElement.parentNode!==null&&d.labelElement.parentNode.removeChild(d.labelElement);if(g.length!==0){d.labelElement=b.createElementNS(a.svgns,"text");var h=a.util.calculateLabelPositioning(this.size().width,g,d.calculationClasses);d.adaptSizeToLabel===!0?f.call(this,h):e.call(this,h),d.labelElement.setAttributeNS(null,"class",d.svgClasses),this.nodeGroup().appendChild(d.labelElement)}};a.Labelable=function(){a.Labelable.superClazz.apply(this,arguments),this._addType(a.Labelable.ListenerType);var b=this._privates(c);b.label=this._label,b.adaptSizeToLabel=this._adaptSizeToLabel,b.labelElement=null,b.svgClasses=this._svgClasses,b.calculationClasses=this._calculationClasses;var e=g.createDelegate(this);this.bind(a.Labelable.ListenerType.label,e,d(this)),this.bind(a.Labelable.ListenerType.adaptSizeToLabel,e,d(this)),this.bind(a.Labelable.ListenerType.labelClass,e,d(this)),this.bind(a.Node.ListenerType.size,e,d(this))},a.Labelable.prototype={_label:"",_adaptSizeToLabel:!1,_svgClasses:"",_calculationClasses:[a.settings.css.classes.textDimensionCalculation.standard],label:function(b){var d=this._privates(c);if(b!==undefined){b=b===null?"":b,b!=d.label&&(d.label=b,this.fire(a.Labelable.ListenerType.label,[this,b]));return this}return d.label},adaptSizeToLabel:function(b){var d=this._privates(c);if(b!==undefined){b!==d.adaptSizeToLabel&&(d.adaptSizeToLabel=b,this.fire(a.Labelable.ListenerType.adaptSizeToLabel,[this,b]));return this}return d.adaptSizeToLabel},labelClass:function(b,d){var e=this._privates(c);e.svgClasses=b,e.calculationClasses=d,this.fire(a.Labelable.ListenerType.labelClass,[this]);return this},sizeBasedOnLabel:function(){var b=this._privates(c),d=a.util.calculateLabelPositioning(300,this.label(),b.calculationClasses),e=Number.MIN_VALUE,f=Number.MIN_VALUE;for(var g=0;g<d.length;g++){var h=d[g];f=Math.max(f,h.totalWidth),e=Math.max(e,h.maxHeight)}var i=a.settings.style.adaptToLabelNodePadding;f+=i.left+i.right,e+=i.top+i.bottom;return{width:f,height:e}}},a.util.setSuperClass(a.Labelable,a.Node),a.Labelable.ListenerType={label:a.util.createListenerTypeId(),adaptSizeToLabel:a.util.createListenerTypeId(),labelClass:a.util.createListenerTypeId()}}(bui),function(a){var c="bui.EdgeHandle",d=function(a){return c+a.id()},e=function(a,b){var d=b/2,e=this._privates(c);e.circle.setAttributeNS(null,"cx",d),e.circle.setAttributeNS(null,"cy",d),e.circle.setAttributeNS(null,"r",d)},f=function(){var d=this._privates(c);d.circle=b.createElementNS(a.svgns,"circle"),e.call(this,this,this.size().width),this.nodeGroup().appendChild(d.circle)};a.EdgeHandle=function(){a.EdgeHandle.superClazz.apply(this,arguments),this.bind(a.Node.ListenerType.size,e.createDelegate(this),d(this)),f.call(this);var b=a.settings.style.edgeHandleRadius*2;this.size(b,b)},a.EdgeHandle.prototype={_circle:null,_forceRectangular:!0,_enableResizing:!1,_calculationHook:g},a.util.setSuperClass(a.EdgeHandle,a.Node)}(bui),function(a){a.SplineEdgeHandle=function(){a.SplineEdgeHandle.superClazz.apply(this,arguments),this.addClass(a.settings.css.classes.splineEdgeHandle),this.position(10,10)},a.util.setSuperClass(a.SplineEdgeHandle,a.EdgeHandle)}(bui),function(a){var c="bui.RectangularNode",d=function(a,b,c,d,e,f,g){return[a,",",b," ",c," ",d,",",e," ",f,",",g].join("")},e=function(a,b,c,e){var f=[];f.push("M"+a/2+","+0),f.push("H"+(a-c)),c>0&&f.push("A"+d(c,c,0,0,1,a,c)),f.push("V"+(b-e)),e>0&&f.push("A"+d(e,e,0,0,1,a-e,b)),f.push("H"+e),e>0&&f.push("A"+d(e,e,0,0,1,0,b-e)),f.push("V"+c),c>0&&f.push("A"+d(c,c,0,0,1,c,0)),f.push("Z");return f.join(" ")},f=function(a){return c+a.id()},g=function(){var a=this._privates(c),b=this.size();a.rect.setAttributeNS(null,"d",e(b.width,b.height,a.topRadius,a.bottomRadius))},h=function(){var d=this.nodeGroup(),e=this._privates(c);e.rect=b.createElementNS(a.svgns,"path");var f=this.size();g.call(this,this,f.width,f.height),d.appendChild(e.rect)};a.RectangularNode=function(){a.RectangularNode.superClazz.apply(this,arguments),this._addType(a.RectangularNode.ListenerType);var b=g.createDelegate(this);this.bind(a.Node.ListenerType.size,b,f(this)),this.bind(a.RectangularNode.ListenerType.topRadius,b,f(this)),this.bind(a.RectangularNode.ListenerType.bottomRadius,b,f(this));var d=this._privates(c);d.topRadius=0,d.bottomRadius=0,h.call(this),this.addClass(a.settings.css.classes.rectangle)},a.RectangularNode.prototype={topRadius:function(b){var d=this._privates(c);if(b!==undefined){d.topRadius!==b&&(d.topRadius=b,this.fire(a.RectangularNode.ListenerType.topRadius,[this,b]));return this}return d.topRadius},bottomRadius:function(b){var d=this._privates(c);if(b!==undefined){d.bottomRadius!==b&&(d.bottomRadius=b,this.fire(a.RectangularNode.ListenerType.bottomRadius,[this,b]));return this}return d.bottomRadius}},a.util.setSuperClass(a.RectangularNode,a.Labelable),a.RectangularNode.ListenerType={topRadius:a.util.createListenerTypeId(),bottomRadius:a.util.createListenerTypeId()}}(bui),function(a){var b="bui.UnitOfInformation",c=function(a){return b+a.id()};a.UnitOfInformation=function(){a.UnitOfInformation.superClazz.apply(this,arguments),this.labelClass(a.settings.css.classes.smallText,[a.settings.css.classes.textDimensionCalculation.small]),this.adaptSizeToLabel(!0)},a.UnitOfInformation.prototype={_enableResizing:!1},a.util.setSuperClass(a.UnitOfInformation,a.RectangularNode)}(bui),function(a){a.Macromolecule=function(){a.Macromolecule.superClazz.apply(this,arguments),this.topRadius(a.settings.style.nodeCornerRadius),this.bottomRadius(a.settings.style.nodeCornerRadius)},a.util.setSuperClass(a.Macromolecule,a.RectangularNode)}(bui),function(a){var c="bui.Complex",d=function(a){return c+a.id()},e=function(b,d,e){var f=a.settings.style.complexCornerRadius,g=["M",d/2,0,"H",d-f,"L",d,f,"V",e-f,"L",d-f,e,"H",f,"L",0,e-f,"V",f,"L",f,0,"H",d/2].join(" ");this._privates(c).path.setAttributeNS(null,"d",g)},f=function(){var d=this.nodeGroup(),f=this.size(),g=this._privates(c);g.path=b.createElementNS(a.svgns,"path"),e.call(this,this,f.width,f.height),d.appendChild(g.path)};a.Complex=function(){a.Node.apply(this,arguments),this.bind(a.Node.ListenerType.size,e.createDelegate(this),d(this)),f.call(this),this.addClass(a.settings.css.classes.complex)},a.util.setSuperClass(a.Complex,a.Node)}(bui),function(a){var c="bui.Compartment",d=function(a){return c+a.id()},e=function(a,b,d){var e=this._privates(c);e.rect.setAttributeNS(null,"width",b),e.rect.setAttributeNS(null,"height",d)},f=function(){var d=this.nodeGroup(),f=this.size(),g=this._privates(c);g.rect=b.createElementNS(a.svgns,"rect");var h=a.settings.style.compartmentCornerRadius;g.rect.setAttributeNS(null,"rx",h.x),g.rect.setAttributeNS(null,"ry",h.y),e.call(this,this,f.width,f.height),d.appendChild(g.rect)};a.Compartment=function(){a.Compartment.superClazz.apply(this,arguments),this.bind(a.Node.ListenerType.size,e.createDelegate(this),d(this)),f.call(this),this.addClass(a.settings.css.classes.compartment),this._privates(c).label=this.graph().add(a.Labelable).parent(this).visible(!0).adaptSizeToLabel(!0)},a.Compartment.prototype={label:function(){var a=this._privates(c).label;return a.label.apply(a,arguments)},labelPosition:function(){var a=this._privates(c).label;return a.position.apply(a,arguments)}},a.util.setSuperClass(a.Compartment,a.Node)}(bui),function(a){a.NucleicAcidFeature=function(){a.NucleicAcidFeature.superClazz.apply(this,arguments),this.bottomRadius(a.settings.style.nodeCornerRadius)},a.util.setSuperClass(a.NucleicAcidFeature,a.RectangularNode)}(bui),function(a){var c="bui.StateVariable",d=function(a){return c+a.id()},e=function(a,b,d){var e=b/2,f=d/2,g=this._privates(c);g.ellipse.setAttributeNS(null,"cx",e),g.ellipse.setAttributeNS(null,"cy",f),g.ellipse.setAttributeNS(null,"rx",e),g.ellipse.setAttributeNS(null,"ry",f)},f=function(){var d=this._privates(c);d.ellipse=b.createElementNS(a.svgns,"ellipse");var f=this.size();e.call(this,this,f.width,f.height),this.nodeGroup().appendChild(d.ellipse)};a.StateVariable=function(){a.StateVariable.superClazz.apply(this,arguments),this.bind(a.Node.ListenerType.size,e.createDelegate(this),d(this)),f.call(this),this.labelClass(a.settings.css.classes.smallText,[a.settings.css.classes.textDimensionCalculation.small]),this.adaptSizeToLabel(!0)},a.StateVariable.prototype={_enableResizing:!1},a.util.setSuperClass(a.StateVariable,a.Labelable)}(bui),function(a){var c="bui.SimpleChemical",d=function(a){return c+a.id()},e=function(a,b){var d=b/2,e=this._privates(c);e.circle.setAttributeNS(null,"cx",d),e.circle.setAttributeNS(null,"cy",d),e.circle.setAttributeNS(null,"r",d)},g=function(){var d=this.nodeGroup(),f=this._privates(c);f.circle=b.createElementNS(a.svgns,"circle"),e.call(this,this,this.size().width),d.appendChild(f.circle)};a.SimpleChemical=function(){a.SimpleChemical.superClazz.apply(this,arguments),this.bind(a.Node.ListenerType.size,e.createDelegate(this),d(this)),g.call(this)},a.SimpleChemical.prototype={_forceRectangular:!0,_calculationHook:f},a.util.setSuperClass(a.SimpleChemical,a.Labelable)}(bui),function(a){var c="bui.UnspecifiedEntity",d=function(a){return c+a.id()},e=function(a,b,d){var e=b/2,f=d/2,g=this._privates(c);g.ellipse.setAttributeNS(null,"cx",e),g.ellipse.setAttributeNS(null,"cy",f),g.ellipse.setAttributeNS(null,"rx",e),g.ellipse.setAttributeNS(null,"ry",f)},f=function(){var d=this.nodeGroup(),f=this._privates(c);f.ellipse=b.createElementNS(a.svgns,"ellipse");var g=this.size();e.call(this,this,g.width,g.height),d.appendChild(f.ellipse)};a.UnspecifiedEntity=function(){a.UnspecifiedEntity.superClazz.apply(this,arguments),this.bind(a.Node.ListenerType.size,e.createDelegate(this),d(this)),f.call(this)},a.util.setSuperClass(a.UnspecifiedEntity,a.Labelable)}(bui),function(a){a.Process=function(){a.Process.superClazz.apply(this,arguments),this.labelClass(a.settings.css.classes.smallText,[a.settings.css.classes.textDimensionCalculation.small])},a.Process.prototype={_enableResizing:!1,_minWidth:a.settings.style.processNodeMinSize.width,_minHeight:a.settings.style.processNodeMinSize.height},a.util.setSuperClass(a.Process,a.RectangularNode)}(bui),function(a){var b="bui.AttachedDrawable",c=function(a){return b+a.id()},d=function(){this.source(null)},e=function(){this.target(null)},f=function(b,e,f){e!==null&&e.bind(a.Drawable.ListenerType.remove,d.createDelegate(this),c(this)),f!==null&&f.unbindAll(c(this))},g=function(b,d,f){d!==null&&d.bind(a.Drawable.ListenerType.remove,e.createDelegate(this),c(this)),f!==null&&f.unbindAll(c(this))},h=function(){var a=this._privates(b);a.source!==null&&a.source.unbindAll(c(this)),a.target!==null&&a.target.unbindAll(c(this))};a.AttachedDrawable=function(){a.AttachedDrawable.superClazz.apply(this,arguments),this._addType(a.AttachedDrawable.ListenerType),this.bind(a.AttachedDrawable.ListenerType.source,f.createDelegate(this),c(this)),this.bind(a.AttachedDrawable.ListenerType.target,g.createDelegate(this),c(this)),this.bind(a.Drawable.ListenerType.remove,h.createDelegate(this),c(this));var d=this._privates(b);d.source=null,d.target=null},a.AttachedDrawable.prototype={source:function(c){var d=this._privates(b);if(c!==undefined){if(c!==d.source){var e=d.source;d.source=c,this.fire(a.AttachedDrawable.ListenerType.source,[this,d.source,e])}return this}return d.source},target:function(c){var d=this._privates(b);if(c!==undefined){if(c!==d.target){var e=d.target;d.target=c,this.fire(a.AttachedDrawable.ListenerType.target,[this,d.target,e])}return this}return d.target}},a.util.setSuperClass(a.AttachedDrawable,a.Drawable),a.AttachedDrawable.ListenerType={source:a.util.createListenerTypeId(),target:a.util.createListenerTypeId()}}(bui),function(a){var b="bui.AbstractLine",c=function(a){return b+a.id()},d=function(b,c){c===!0?this.removeClass(a.settings.css.classes.invisible):this.addClass(a.settings.css.classes.invisible)},e=function(a,b){this._line.setAttributeNS(null,"class",b)},f=function(){this._line.parentNode.removeChild(this._line)},g=function(){var a=this.source(),b=this.target();this.visible(a!==null&&b!==null&&a.visible()===!0&&b.visible()===!0)},h=function(b,d,e){e!==null&&e.unbindAll(c(this));if(d!==null){var f=this._sourceOrTargetDimensionChanged.createDelegate(this);d.bind(a.Node.ListenerType.position,f,c(this)),d.bind(a.Node.ListenerType.size,f,c(this)),d.bind(a.Drawable.ListenerType.visible,g.createDelegate(this),c(this))}this._sourceOrTargetDimensionChanged(),g.call(this)},i=function(b,d,e){e!==null&&e.unbindAll(c(this));if(d!==null){var f=this._sourceOrTargetDimensionChanged.createDelegate(this);d.bind(a.Node.ListenerType.position,f,c(this)),d.bind(a.Node.ListenerType.size,f,c(this)),d.bind(a.Drawable.ListenerType.visible,g.createDelegate(this),c(this))}this._sourceOrTargetDimensionChanged(),g.call(this)},j=function(b){this.hoverEffectActive(!0),this.fire(a.AbstractLine.ListenerType.mouseEnter,[this,b])},k=function(b){this.hoverEffectActive(!1),this.fire(a.AbstractLine.ListenerType.mouseLeave,[this,b])},l=function(c,d){var e;d===!0&&this.hoverEffect()?(this.addClass(a.settings.css.classes.lineHover),e=this._privates(b).marker,e!==null&&this._line.setAttributeNS(null,"marker-end",a.util.createMarkerAttributeValue(a.util.getHoverId(e)))):(this.removeClass(a.settings.css.classes.lineHover),e=this._privates(b).marker,e!==null&&this._line.setAttributeNS(null,"marker-end",a.util.createMarkerAttributeValue(e)))},m=function(b){this.fire(a.AbstractLine.ListenerType.click,[this,b])},n=function(b){this.fire(a.AbstractLine.ListenerType.mousedown,[this,b])};a.AbstractLine=function(g){g.id=a.settings.idPrefix.edge+g.id,a.AbstractLine.superClazz.call(this,g),this._addType(a.AbstractLine.ListenerType);var o=this._privates(b);o.hoverEffect=!0,o.marker=null,o.hoverEffectActive=!1,this.bind(a.Drawable.ListenerType.visible,d.createDelegate(this),c(this)),this.bind(a.Drawable.ListenerType.classes,e.createDelegate(this),c(this)),this.bind(a.Drawable.ListenerType.remove,f.createDelegate(this),c(this)),this.bind(a.AttachedDrawable.ListenerType.source,h.createDelegate(this),c(this)),this.bind(a.AttachedDrawable.ListenerType.target,i.createDelegate(this),c(this)),this.bind(a.AbstractLine.ListenerType.marker,this._markerChanged.createDelegate(this),c(this)),this.bind(a.AbstractLine.ListenerType.hoverEffectActive,l.createDelegate(this),c(this)),this._initialPaint(),this._line.setAttributeNS(null,"id",this.id()),jQuery(this._line).mouseenter(j.createDelegate(this)),jQuery(this._line).mouseleave(k.createDelegate(this)),jQuery(this._line).click(m.createDelegate(this)),jQuery(this._line).mousedown(n.createDelegate(this)),this.addClass(a.settings.css.classes.line)},a.AbstractLine.prototype={_line:null,_initialPaint:function(){throw"Not implemented!"},_sourceOrTargetDimensionChanged:function(){throw"Not implemented!"},_markerChanged:function(b,c){c===null?(this._line.setAttributeNS(null,"marker-end",""),this._line.removeAttributeNS(null,"marker-end")):this._line.setAttributeNS(null,"marker-end",a.util.createMarkerAttributeValue(c))},marker:function(c){var d=this._privates(b);if(c!==undefined){if(c===null)d.marker=null,this.fire(a.AbstractLine.ListenerType.marker,[this,null]);else{var e=this.graph().connectingArcs()[c];e!==undefined&&e.id!==d.marker&&(d.marker=e.id,this.fire(a.AbstractLine.ListenerType.marker,[this,e.id]))}return this}return d.marker},lineStyle:function(b){for(var c in a.AbstractLine.Style)a.AbstractLine.Style.hasOwnProperty(c)&&this.removeClass(a.AbstractLine.Style[c]);this.addClass(a.AbstractLine.Style[b]);return this},hoverEffect:function(a){var c=this._privates(b);if(a!==undefined){c.hoverEffect=a;return this}return c.hoverEffect},hoverEffectActive:function(c){var d=this._privates(b);if(c!==undefined){c=c&&this.hoverEffect(),c!==d.hoverEffectActive&&(d.hoverEffectActive=c,this.fire(a.AbstractLine.ListenerType.hoverEffectActive,[this,c]));return this}return d.hoverEffectActive}},a.util.setSuperClass(a.AbstractLine,a.AttachedDrawable),a.AbstractLine.ListenerType={marker:a.util.createListenerTypeId(),click:a.util.createListenerTypeId(),mousedown:a.util.createListenerTypeId(),mouseEnter:a.util.createListenerTypeId(),mouseLeave:a.util.createListenerTypeId(),hoverEffectActive:a.util.createListenerTypeId()},a.AbstractLine.Style={solid:a.settings.css.classes.lineStyle.solid,dotted:a.settings.css.classes.lineStyle.dotted,dashed:a.settings.css.classes.lineStyle.dashed}}(bui),function(a){var c="bui.StraightLine",d=function(a){return c+a.id()};a.StraightLine=function(b){a.StraightLine.superClazz.apply(this,arguments)},a.StraightLine.prototype={_initialPaint:function(){var d=this._privates(c);this._line=b.createElementNS(a.svgns,"line"),this.graph().edgeGroup().appendChild(this._line),this.addClass(a.settings.css.classes.invisible)},_sourceOrTargetDimensionChanged:function(){var a=this.target(),b=this.source();if(a!==null&&b!==null){var c=b.calculateLineEnd(a);this._line.setAttributeNS(null,"x1",c.x),this._line.setAttributeNS(null,"y1",c.y),c=a.calculateLineEnd(b),this._line.setAttributeNS(null,"x2",c.x),this._line.setAttributeNS(null,"y2",c.y)}}},a.util.setSuperClass(a.StraightLine,a.AbstractLine)}(bui),function(a){var c="bui.Spline",d=function(a){return c+a.id()},e=function(a,b){var d=this._privates(c);d.sourceHelperLine.target(b)},f=function(a,b){var d=this._privates(c);d.targetHelperLine.target(b)},g=function(a,b){b===!1&&this.layoutElementsVisible(!1)},h=function(a){a.ctrlKey===!0&&this.layoutElementsVisible(!this.layoutElementsVisible())};a.Spline=function(b){a.Spline.superClazz.apply(this,arguments),this.bind(a.AttachedDrawable.ListenerType.source,e.createDelegate(this),d(this)),this.bind(a.AttachedDrawable.ListenerType.target,f.createDelegate(this),d(this)),this.bind(a.Drawable.ListenerType.visible,g.createDelegate(this),d(this))},a.Spline.prototype={_initialPaint:function(){var e=this._privates(c);e.layoutElementsVisible=!0,this._line=b.createElementNS(a.svgns,"path"),this.graph().edgeGroup().appendChild(this._line),this.addClass(a.settings.css.classes.invisible);var f=this._sourceOrTargetDimensionChanged.createDelegate(this);e.sourceSplineHandle=this.graph().add(a.SplineEdgeHandle).bind(a.Node.ListenerType.absolutePosition,f,d(this)).visible(e.layoutElementsVisible),e.targetSplineHandle=this.graph().add(a.SplineEdgeHandle).bind(a.Node.ListenerType.absolutePosition,f,d(this)).visible(e.layoutElementsVisible),e.sourceHelperLine=this.graph().add(a.StraightLine).lineStyle(a.AbstractLine.Style.dotted).hoverEffect(!1).source(e.sourceSplineHandle).visible(e.layoutElementsVisible),e.targetHelperLine=this.graph().add(a.StraightLine).lineStyle(a.AbstractLine.Style.dotted).hoverEffect(!1).source(e.targetSplineHandle).visible(e.layoutElementsVisible),jQuery(this._line).click(h.createDelegate(this))},_sourceOrTargetDimensionChanged:function(){var a=this.target(),b=this.source();if(a!==null&&b!==null){var d=this._privates(c),e=d.sourceSplineHandle,f=d.targetSplineHandle,g=b.calculateLineEnd(e),h=a.calculateLineEnd(f),i=e.absoluteCenter(),j=f.absoluteCenter(),k=["M",g.x,g.y,"C",i.x,i.y,j.x,j.y,h.x,h.y].join(" ");this._line.setAttributeNS(null,"d",k)}},layoutElementsVisible:function(a){var b=this._privates(c);if(a!==undefined){b.layoutElementsVisible=a,b.sourceSplineHandle.visible(a),b.targetSplineHandle.visible(a),b.sourceHelperLine.visible(a),b.targetHelperLine.visible(a);return this}return b.layoutElementsVisible}},a.util.setSuperClass(a.Spline,a.AbstractLine)}(bui),function(a){var b="bui.Edge",c=function(a){return b+a.id()},d=function(){var a=this.source(),b=this.target();this.visible(a!==null&&a.visible()===!0&&b!==null&&b.visible()===!0)},e=function(e,f,g){var h=this._privates(b);h.lines[0].source(f),g!==null&&g.unbindAll(c(this)),f!==null&&f.bind(a.Drawable.ListenerType.visible,d.createDelegate(this),c(this))},f=function(e,f,g){var h=this._privates(b);h.lines[h.lines.length-1].target(f),g!==null&&g.unbindAll(c(this)),f!==null&&f.bind(a.Drawable.ListenerType.visible,d.createDelegate(this),c(this))},g=function(){var a=this._privates(b),c=this.visible()===!0&&a.edgeHandlesVisible===!0,d=a.handles;for(var e=0;e<d.length;e++)d[e].visible(c)},h=function(a,c){var d=this._privates(b),e=d.lines;for(var f=0;f<e.length;f++)e[f].visible(c);g.call(this)},i=function(){var d=this.graph().suspendRedraw(200),e=this._privates(b),f=e.lines;for(var g=0;g<f.length;g++)f[g].remove();var h=e.handles,i=this.graph(),j=l.createDelegate(this),o=k.createDelegate(this),p=m.createDelegate(this),q=n.createDelegate(this),r=c(this),s=this.source(),t=null;f=[];var u=function(){var b=i.add(a.StraightLine).source(s).target(t).bind(a.AbstractLine.ListenerType.click,j,r).bind(a.AbstractLine.ListenerType.mousedown,o,r).bind(a.AbstractLine.ListenerType.mouseEnter,p,r).bind(a.AbstractLine.ListenerType.mouseLeave,q,r);f.push(b),s=t};for(g=0;g<h.length;g++)t=h[g],u();t=this.target(),u(),e.lines=f,this.graph().unsuspendRedraw(d)},j=function(c,d,e){var f=this._privates(b),g=this.graph().htmlTopLeft();d-=g.x,e-=g.y;var h=this.graph().add(a.EdgeHandle).positionCenter(d,e).visible(f.edgeHandlesVisible),j=f.handles.indexOf(c);j===-1?j=0:j++,f.handles.splice(j,0,h),i.call(this),h.startDragging(d,e)},k=function(a,b){b.ctrlKey!==!0&&j.call(this,a.source(),b.pageX,b.pageY)},l=function(a,b){b.ctrlKey===!0&&this.edgeHandlesVisible(!this.edgeHandlesVisible())},m=function(){var a=this._privates(b),c=a.lines;for(var d=0;d<c.length;d++)c[d].hoverEffectActive(!0)},n=function(){var a=this._privates(b),c=a.lines;for(var d=0;d<c.length;d++)c[d].hoverEffectActive(!1)};a.Edge=function(){a.Edge.superClazz.apply(this,arguments);var d=this._privates(b);d.edgeHandlesVisible=!0,d.handles=[],d.lines=[],i.call(this),this.bind(a.AttachedDrawable.ListenerType.source,e.createDelegate(this),c(this)),this.bind(a.AttachedDrawable.ListenerType.target,f.createDelegate(this),c(this)),this.bind(a.Drawable.ListenerType.visible,h.createDelegate(this),c(this))},a.Edge.prototype={edgeHandlesVisible:function(a){var c=this._privates(b);if(a!==undefined){c.edgeHandlesVisible=a,g.call(this);return this}return c.edgeHandlesVisible}},a.util.setSuperClass(a.Edge,a.AttachedDrawable)}(bui),function(a){var b=function(a,b,c,d){var e={klass:c};d!==undefined&&(e.generator=d);for(var f=0;f<b.length;f++)a[b[f]]=e},c={},d={},e={};b(c,[285],a.UnspecifiedEntity),b(c,[247],a.SimpleChemical),b(c,[245,252],a.Macromolecule),b(c,[250,251],a.NucleicAcidFeature),b(c,[253],a.Complex),b(c,[290],a.Compartment),b(d,[375],a.Process),b(e,[19],a.connectingArcs.modulation.id),b(e,[20],a.connectingArcs.inhibition.id),b(e,[459],a.connectingArcs.stimulation.id),b(e,[461],a.connectingArcs.necessaryStimulation.id),b(e,[13],a.connectingArcs.catalysis.id);var f=function(a,b){if(a.hasOwnProperty(b))return a[b];throw'SBO id "'+b+'" could not be found.'},g=function(){var a=arguments[0];for(var b=1;b<arguments.length;b++){var c=arguments[b];if(a.hasOwnProperty(c)===!1||a[c]===null)return!1}return!0},i=function(b,c,d){var e=b.add(c.klass);g(d.data,"label")&&e.label!==undefined&&e.label(d.data.label),g(d.data,"x","y")&&(d.data.x=h(d.data.x),d.data.y=h(d.data.y),e.position(d.data.x,d.data.y));var f=a.settings.style.importer.standardNodeSize,i={width:f.width,height:f.height};if(e.sizeBasedOnLabel!==undefined){i=e.sizeBasedOnLabel();var j=a.settings.style.importer.sizeBasedOnLabelPassing;i.width+=j.horizontal,i.height+=j.vertical}e.size(i.width,i.height).visible(!0);return e},j=function(a){var b=a.id;a.data.ref!==undefined&&(b=a.data.ref);return b},k=function(a,b){var d=b.nodes,e={},g,h;for(var k=0;k<d.length;k++)try{h=d[k];var l=f(c,h.sbo);l.hasOwnProperty("generator")?g=l.generator(a,h):g=i(a,l,h),g.json(h),e[j(h)]=g}catch(m){console.log(m)}for(var n in e)if(e.hasOwnProperty(n)){g=e[n],h=g.json();if(h.data.subnodes!==undefined)for(var o=0;o<h.data.subnodes.length;o++){var p=h.data.subnodes[o],q=e[p];q.parent(g)}}return e},l=function(b){var c=b.children();for(var d=0;d<c.length;d++){var e=c[d];e instanceof a.Complex&&l(e)}},m=function(b){for(var c in b)if(b.hasOwnProperty(c)){var d=b[c];d instanceof a.Complex&&d.parent()===d.graph()&&l(d)}};a.importFromJSON=function(a,b){var c=k(a,b);m(c)}}(bui),a.bui=bui})(window)